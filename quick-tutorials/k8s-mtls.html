<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-quick-tutorials/k8s-mtls">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">Simple mTLS deployment | Otterize</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.otterize.com/quick-tutorials/k8s-mtls"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Simple mTLS deployment | Otterize"><meta data-rh="true" name="description" content="Otterize can automatically provision mTLS credentials by using the service identities implied by Kubernetes."><meta data-rh="true" property="og:description" content="Otterize can automatically provision mTLS credentials by using the service identities implied by Kubernetes."><link data-rh="true" rel="icon" href="/img/favicon.svg"><link data-rh="true" rel="canonical" href="https://docs.otterize.com/quick-tutorials/k8s-mtls"><link data-rh="true" rel="alternate" href="https://docs.otterize.com/quick-tutorials/k8s-mtls" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.otterize.com/quick-tutorials/k8s-mtls" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://69PZ47MO2R-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Otterize" href="/opensearch.xml">

<script>!function(t,h,e,j,s,n){t.hj=t.hj||function(){(t.hj.q=t.hj.q||[]).push(arguments)},t._hjSettings={hjid:3156902,hjsv:6},s=h.getElementsByTagName("head")[0],(n=h.createElement("script")).async=1,n.src="https://static.hotjar.com/c/hotjar-"+t._hjSettings.hjid+".js?sv="+t._hjSettings.hjsv,s.appendChild(n)}(window,document)</script>
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2EG876ZREF"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-2EG876ZREF",{})</script>
<script src="/newsLetterSubscription.js" async></script>
<script src="/pixels.js" async></script><link rel="stylesheet" href="/assets/css/styles.774045a5.css">
<link rel="preload" href="/assets/js/runtime~main.31873fae.js" as="script">
<link rel="preload" href="/assets/js/main.b1380054.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://otterize.com" target="_self" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/img/otterize-logo-light.svg" alt="Otterize" class="themedImage_ToTc themedImage--light_HNdA" style="padding-left:15px"><img src="/img/otterize-logo-light.svg" alt="Otterize" class="themedImage_ToTc themedImage--dark_i4oU" style="padding-left:15px"></div></a></div><div class="navbar__items navbar__items--right"><a href="https://otterize.com/open-source" target="_self" rel="noopener noreferrer" class="navbar__item navbar__link">Open source<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://otterize.com/product" target="_self" rel="noopener noreferrer" class="navbar__item navbar__link">Product<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://otterize.com/ibac" target="_self" rel="noopener noreferrer" class="navbar__item navbar__link">IBAC<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Docs</a><a href="https://otterize.com/pricing" target="_self" rel="noopener noreferrer" class="navbar__item navbar__link">Pricing<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://otterize.com/team" target="_self" rel="noopener noreferrer" class="navbar__item navbar__link">Team<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://otterize.com/blog" target="_self" rel="noopener noreferrer" class="navbar__item navbar__link">Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/otterize" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link" class="navbar_external_logo_first"><img src="/img/github-round-logo.svg"></a><a href="https://joinslack.otterize.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link" class="navbar_external_logo"><img src="/img/slack-logo-no-border.svg"></a><a href="https://app.otterize.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link" class="launch_app">Launch App</a><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Getting started</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/quick-tutorials/k8s-network-policies">Quick hands-on tutorials</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/quick-tutorials/k8s-network-policies">Simple network policy automation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/quick-tutorials/k8s-kafka-mtls">Simple, secure Kafka access</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/quick-tutorials/k8s-network-mapper">Simple Kubernetes cluster mapping</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/quick-tutorials/k8s-mtls">Simple mTLS deployment</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" href="/quick-visual-tutorials/visual-k8s-cluster-mapping">Quick visual tutorials</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/quick-visual-tutorials/visual-k8s-cluster-mapping">Kubernetes cluster mapping</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/quick-visual-tutorials/visual-ibac-network-policies">IBAC with network policies</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/quick-visual-tutorials/visual-ibac-kafka-k8s">IBAC for Kafka in Kubernetes</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/installation">Installation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/intent-based-access-control">IBAC: Intent-based access control</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/shadow-vs-active-enforcement">Shadow vs active enforcement</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/otterize-oss">Otterize OSS</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/otterize-cloud">Otterize Cloud</a><button aria-label="Toggle the collapsible sidebar category &#x27;Otterize Cloud&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" href="/reference/configuration/otterize-chart">Reference</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/reference/configuration/otterize-chart">Configuration</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/cli">CLI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/api">API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/intents-and-intents-files">Intents and intents files</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/service-identities">Service identities and resolution</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/terminology">Terminology</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/network-policies">Network policies deep dive</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/mtls">Kubernetes mTLS</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/security">Security</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/faq">FAQ</a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Quick hands-on tutorials</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Simple mTLS deployment</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Simple mTLS deployment</h1></header><p>Otterize can automatically provision mTLS credentials by using the service identities implied by Kubernetes.
This tutorial will walk you through deploying mTLS certificates on a sample client-server deployment using the <a href="/reference/configuration/credentials-operator">Otterize credentials operator</a>.
You can configure this operator to use a <a href="https://spiffe.io/docs/latest/spire-about/" target="_blank" rel="noopener noreferrer">local SPIRE server</a> to issue and manage certificates, or to use the Otterize Cloud service to manage this for you.
You can read more about these options in the <a href="/security#cryptographic-credentials">cryptographic credentials documentation</a>.</p><p>In this tutorial, we will:</p><ul><li>Deploy client and server pods communicating over HTTP with mTLS.</li><li>See that mTLS credentials were autogenerated.</li></ul><p>We&#x27;ll start by installing Otterize. You can do so just using Otterize OSS, without it to Otterize Cloud, and use SPIRE for certificates. Or you can do so with Otterize OSS connected to Otterize Cloud, which adds web visualization as well as the <em>option</em> of using Cloud-managed credentials. (You can also connect to Cloud but still use SPIRE; refer to the <a href="/security#cryptographic-credentials">cryptographic credentials documentation</a>.)</p><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Install Otterize in your cluster, <b>without</b> Otterize Cloud</summary><div><div class="collapsibleContent_i85q"><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Basic system memory requirements</div><div class="admonitionContent_S0QG"><p>Otterize requires about 200 MBs and 200 mCPU for all components (including a SPIRE deployment) to install and run properly on Minikube and EKS clusters.</p></div></div><p>   You&#x27;ll need <a href="https://helm.sh/docs/intro/install/" target="_blank" rel="noopener noreferrer">Helm</a> installed on your machine to install Otterize as follows:</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">helm repo </span><span class="token function" style="color:#79b6f2">add</span><span class="token plain"> otterize https://helm.otterize.com</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">helm repo update</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">helm </span><span class="token function" style="color:#79b6f2">install</span><span class="token plain"> otterize otterize/otterize-kubernetes -n otterize-system --create-namespace</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This chart is a bundle of the Otterize intents operator, Otterize credentials operator, Otterize network mapper, and SPIRE.
Initial deployment may take a couple of minutes.
You can add the <code>--wait</code> flag for Helm to wait for deployment to complete and all pods to be Ready, or manually watch for all pods to be <code>Ready</code> using <code>kubectl get pods -n otterize-system -w</code>.</p><p>After all the pods are ready you should see the following (or similar) in your terminal when you run <code>kubectl get pods -n otterize-system</code>:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">NAME                                                       READY  STATUS  RESTARTS AGE</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">credentials-operator-controller-manager-6c56fcfcfb-vg6m9   </span><span class="token number" style="color:#5a9bcf">2</span><span class="token plain">/2    Running   </span><span class="token number" style="color:#5a9bcf">0</span><span class="token plain">     9s</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">intents-operator-controller-manager-65bb6d4b88-bp9pf       </span><span class="token number" style="color:#5a9bcf">2</span><span class="token plain">/2    Running   </span><span class="token number" style="color:#5a9bcf">0</span><span class="token plain">     9s</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">otterize-network-mapper-779fffd959-twjqd                   </span><span class="token number" style="color:#5a9bcf">1</span><span class="token plain">/1    Running   </span><span class="token number" style="color:#5a9bcf">0</span><span class="token plain">     9s</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">otterize-network-sniffer-65mjt                             </span><span class="token number" style="color:#5a9bcf">1</span><span class="token plain">/1    Running   </span><span class="token number" style="color:#5a9bcf">0</span><span class="token plain">     9s</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">otterize-spire-agent-lcbq2                                 </span><span class="token number" style="color:#5a9bcf">1</span><span class="token plain">/1    Running   </span><span class="token number" style="color:#5a9bcf">0</span><span class="token plain">     9s</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">otterize-spire-server-0                                    </span><span class="token number" style="color:#5a9bcf">2</span><span class="token plain">/2    Running   </span><span class="token number" style="color:#5a9bcf">0</span><span class="token plain">     9s</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">otterize-watcher-b9bf87bcd-276nt                           </span><span class="token number" style="color:#5a9bcf">1</span><span class="token plain">/1    Running   </span><span class="token number" style="color:#5a9bcf">0</span><span class="token plain">     9s</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><p>Or choose to include browser visualization and Cloud-managed credentials:</p><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Install Otterize in your cluster, <b>with</b> Otterize Cloud</summary><div><div class="collapsibleContent_i85q"><h4 class="anchor anchorWithStickyNavbar_LWe7" id="create-an-otterize-cloud-account">Create an Otterize Cloud account<a class="hash-link" href="#create-an-otterize-cloud-account" title="Direct link to heading">​</a></h4><p>If you don&#x27;t already have an account, browse to <a href="https://app.otterize.com" target="_blank" rel="noopener noreferrer">https://app.otterize.com</a> to set one up.</p><p>If someone in your team has already created an org in Otterize Cloud, and invited you (using your email address), you may see an invitation to accept.</p><p>Otherwise, you&#x27;ll create a new org, which you can later rename, and invite your teammates to join you there.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="install-otterize-oss-connected-to-otterize-cloud">Install Otterize OSS, connected to Otterize Cloud<a class="hash-link" href="#install-otterize-oss-connected-to-otterize-cloud" title="Direct link to heading">​</a></h4><p>If no Kubernetes clusters are connected to your account, click the &quot;connect your cluster&quot; button to:</p><ol><li>Create a Cloud cluster object, specifying its name and the name of an environment to which all namespaces in that cluster will belong, by default.</li><li>Connect it with your actual Kubernetes cluster, by clicking on the &quot;Connection guide <!-- -->→<!-- -->&quot; link and running the Helm commands shown there.</li></ol><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>More details, if you&#x27;re curious</summary><div><div class="collapsibleContent_i85q"><p>Connecting your cluster simply entails installing Otterize OSS via Helm, using credentials from your account so Otterize OSS can report information needed to visualize the cluster.</p><p>The credentials will already be inlined into the Helm command shown in the Cloud UI, so you just need to copy that line and run it from your shell.
If you don&#x27;t give it the Cloud credentials, Otterize OSS will run fully standalone in your cluster <!-- -->—<!-- --> you just won&#x27;t have the visualization in Otterize Cloud.</p><p>The Helm command shown in the Cloud UI also includes flags to turn off enforcement: Otterize OSS will be running in &quot;shadow mode,&quot; meaning that it will not create network policies to restrict pod-to-pod traffic, or create Kafka ACLs to control access to Kafka topics. Instead, it will report to Otterize Cloud what <strong>would</strong> happen if enforcement were to be enabled, guiding you to implement IBAC without blocking intended access.</p></div></div></details></div></div></details><h2 class="anchor anchorWithStickyNavbar_LWe7" id="deploy-the-example">Deploy the example<a class="hash-link" href="#deploy-the-example" title="Direct link to heading">​</a></h2><p>Our example consists of two pods, &quot;client&quot; and &quot;server&quot;, communicating over HTTP with mTLS.
Otterize makes mTLS easy, requiring just 3 simple changes to a client pod spec:</p><ol><li><strong>Generate credentials</strong>: add the <code>credentials-operator.otterize.com/tls-secret-name</code> annotation, which tells the Otterize
credentials operator to generate mTLS credentials, and to store them in a Kubernetes secret
whose name is the value of this annotation.</li><li><strong>Expose credentials in a volume</strong>: add a volume containing this secret to the pod.</li><li><strong>Mount the volume</strong>: mount the volume in every container in the pod.</li></ol><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Expand to see this structure</summary><div><div class="collapsibleContent_i85q"><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token key atrule" style="color:#FAC863">spec</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token key atrule" style="color:#FAC863">template</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token key atrule" style="color:#FAC863">metadata</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      </span><span class="token key atrule" style="color:#FAC863">annotations</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#ffffff"><span class="token plain">        </span><span class="token comment" style="color:#999999"># 1. Generate credentials as a secret called &quot;client-credentials-secret&quot;:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token key atrule" style="color:#FAC863">credentials-operator.otterize.com/tls-secret-name</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> client</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain">credentials</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain">secret</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token key atrule" style="color:#FAC863">spec</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      </span><span class="token key atrule" style="color:#FAC863">volumes</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#ffffff"><span class="token plain">        </span><span class="token comment" style="color:#999999"># 2. Create a volume containing this secret:</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#FAC863">name</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> otterize</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain">credentials</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#ffffff"><span class="token plain">          </span><span class="token key atrule" style="color:#FAC863">secret</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#ffffff"><span class="token plain">            </span><span class="token key atrule" style="color:#FAC863">secretName</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> client</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain">credentials</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain">secret</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      </span><span class="token key atrule" style="color:#FAC863">containers</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#FAC863">name</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> client</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">          </span><span class="token punctuation" style="color:#8dc891">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">          </span><span class="token key atrule" style="color:#FAC863">volumeMounts</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#ffffff"><span class="token plain">            </span><span class="token comment" style="color:#999999"># 3. Mount volume into container</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#ffffff"><span class="token plain">            </span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#FAC863">name</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> otterize</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain">credentials</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#ffffff"><span class="token plain">              </span><span class="token key atrule" style="color:#FAC863">mountPath</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> /var/otterize/credentials</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#ffffff"><span class="token plain">              </span><span class="token key atrule" style="color:#FAC863">readOnly</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#ff8b50;font-weight:400">true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Expand to see the complete YAML files of the example</summary><div><div class="collapsibleContent_i85q"><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">namespace.yaml</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">client-deployment.yaml</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">client-configmap.yaml</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">client.js</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">server.js</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token key atrule" style="color:#FAC863">apiVersion</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token key atrule" style="color:#FAC863">kind</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> Namespace</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token key atrule" style="color:#FAC863">metadata</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token key atrule" style="color:#FAC863">name</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> otterize</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain">tutorial</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain">kafka</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain">mtls</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token key atrule" style="color:#FAC863">apiVersion</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> apps/v1</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token key atrule" style="color:#FAC863">kind</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> Deployment</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token key atrule" style="color:#FAC863">metadata</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token key atrule" style="color:#FAC863">name</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> client</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token key atrule" style="color:#FAC863">namespace</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> otterize</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain">tutorial</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain">kafka</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain">mtls</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token key atrule" style="color:#FAC863">spec</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token key atrule" style="color:#FAC863">selector</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token key atrule" style="color:#FAC863">matchLabels</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      </span><span class="token key atrule" style="color:#FAC863">app</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> client</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token key atrule" style="color:#FAC863">template</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token key atrule" style="color:#FAC863">metadata</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      </span><span class="token key atrule" style="color:#FAC863">labels</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token key atrule" style="color:#FAC863">app</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> client</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      </span><span class="token key atrule" style="color:#FAC863">annotations</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token key atrule" style="color:#FAC863">credentials-operator.otterize.com/tls-secret-name</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> client</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain">credentials</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain">secret</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token key atrule" style="color:#FAC863">spec</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      </span><span class="token key atrule" style="color:#FAC863">containers</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#FAC863">name</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> client</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">          </span><span class="token key atrule" style="color:#FAC863">image</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> golang</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">          </span><span class="token key atrule" style="color:#FAC863">command</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;/bin/sh&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;-c&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;--&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">          </span><span class="token key atrule" style="color:#FAC863">args</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;while true; do cd /app; cp src/* .; go get main; go run .; sleep infinity; done&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">          </span><span class="token key atrule" style="color:#FAC863">volumeMounts</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#FAC863">name</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> ephemeral</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">              </span><span class="token key atrule" style="color:#FAC863">mountPath</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> /app</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#FAC863">mountPath</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> /app/src</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">              </span><span class="token key atrule" style="color:#FAC863">name</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> client</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain">go</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#FAC863">name</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> otterize</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain">credentials</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">              </span><span class="token key atrule" style="color:#FAC863">mountPath</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> /var/otterize/credentials</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">              </span><span class="token key atrule" style="color:#FAC863">readOnly</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#ff8b50;font-weight:400">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      </span><span class="token key atrule" style="color:#FAC863">volumes</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#FAC863">name</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> client</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain">go</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">          </span><span class="token key atrule" style="color:#FAC863">configMap</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token key atrule" style="color:#FAC863">name</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> client</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain">go</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#FAC863">name</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> otterize</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain">credentials</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">          </span><span class="token key atrule" style="color:#FAC863">secret</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token key atrule" style="color:#FAC863">secretName</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> client</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain">credentials</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain">secret</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#FAC863">name</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> ephemeral</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">          </span><span class="token key atrule" style="color:#FAC863">emptyDir</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token key atrule" style="color:#FAC863">apiVersion</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token key atrule" style="color:#FAC863">kind</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> ConfigMap</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token key atrule" style="color:#FAC863">metadata</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token key atrule" style="color:#FAC863">name</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> client</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain">go</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token key atrule" style="color:#FAC863">namespace</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> otterize</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain">tutorial</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain">kafka</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain">mtls</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token key atrule" style="color:#FAC863">data</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token key atrule" style="color:#FAC863">client.go</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">|</span><span class="token scalar string" style="color:#8dc891"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token scalar string" style="color:#8dc891">    package main</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    import (</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        &quot;crypto/tls&quot;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        &quot;crypto/x509&quot;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        &quot;fmt&quot;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        &quot;github.com/Shopify/sarama&quot;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        &quot;github.com/sirupsen/logrus&quot;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        &quot;io/ioutil&quot;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        &quot;time&quot;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    const (</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        kafkaAddr = &quot;kafka.kafka</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain">9092&quot;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        testTopicName = &quot;mytopic&quot;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        certFile = &quot;/var/otterize/credentials/cert.pem&quot;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        keyFile = &quot;/var/otterize/credentials/key.pem&quot;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        rootCAFile = &quot;/var/otterize/credentials/ca.pem&quot;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    func getTLSConfig()( * tls.Config</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> error) </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        cert</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token key atrule" style="color:#FAC863">err</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> = tls.LoadX509KeyPair(certFile</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> keyFile)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        if err </span><span class="token tag" style="color:#fc929e">!=</span><span class="token plain"> nil </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            return nil</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token key atrule" style="color:#FAC863">fmt.Errorf(&quot;failed loading x509 key pair</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> %w&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> err)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token key atrule" style="color:#FAC863">pool</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> = x509.NewCertPool()</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        rootCAPEM</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token key atrule" style="color:#FAC863">err</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> = ioutil.ReadFile(rootCAFile)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        if err </span><span class="token tag" style="color:#fc929e">!=</span><span class="token plain"> nil </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            return nil</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token key atrule" style="color:#FAC863">fmt.Errorf(&quot;failed loading root CA PEM file</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> %w &quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> err)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        pool.AppendCertsFromPEM(rootCAPEM)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        return </span><span class="token important" style="font-weight:400">&amp;tls.Config</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token key atrule" style="color:#FAC863">Certificates</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain"> tls.Certificate </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                cert</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token key atrule" style="color:#FAC863">RootCAs</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> pool</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> nil</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    func send_messages(producer sarama.SyncProducer) </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token key atrule" style="color:#FAC863">i</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> = 1</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        for </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token key atrule" style="color:#FAC863">msg</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> = fmt.Sprintf(&quot;Message %d </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token plain">sent by client</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain">&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> i)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            _</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            _</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token key atrule" style="color:#FAC863">err</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> = producer.SendMessage( &amp; sarama.ProducerMessage </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token key atrule" style="color:#FAC863">Topic</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> testTopicName</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token key atrule" style="color:#FAC863">Partition</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token number" style="color:#5a9bcf">-1</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token key atrule" style="color:#FAC863">Value</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> sarama.StringEncoder(msg)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain">)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            if err </span><span class="token tag" style="color:#fc929e">!=</span><span class="token plain"> nil </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                return</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            fmt.Printf(&quot;Sent message </span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain"> %s\n&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> msg)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            time.Sleep(2 * time.Second)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            i++</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    func loop_kafka() error </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token key atrule" style="color:#FAC863">addrs</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> = </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain"> string </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            kafkaAddr</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token key atrule" style="color:#FAC863">config</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> = sarama.NewConfig()</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        fmt.Println(&quot;Loading mTLS certificates&quot;)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        config.Net.TLS.Enable = true</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        tlsConfig</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token key atrule" style="color:#FAC863">err</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> = getTLSConfig()</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        if err </span><span class="token tag" style="color:#fc929e">!=</span><span class="token plain"> nil </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            return err</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        config.Net.TLS.Config = tlsConfig</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        fmt.Println(&quot;Connecting to Kafka&quot;)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        config.Net.DialTimeout = 5 * time.Second</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        config.Net.ReadTimeout = 5 * time.Second</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        config.Net.WriteTimeout = 5 * time.Second</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        client</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token key atrule" style="color:#FAC863">err</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> = sarama.NewClient(addrs</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> config)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        if err </span><span class="token tag" style="color:#fc929e">!=</span><span class="token plain"> nil </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            return err</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        fmt.Println(&quot;Creating a producer and a consumer for </span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain">&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> testTopicName)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        config.Producer.Return.Successes = true</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        config.Producer.Timeout = 5 * time.Second</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        config.Consumer.MaxWaitTime = 5 * time.Second</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        config.Producer.Return.Errors = true</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        config.Consumer.Return.Errors = true</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        producer</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token key atrule" style="color:#FAC863">err</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> = sarama.NewSyncProducerFromClient(client)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        if err </span><span class="token tag" style="color:#fc929e">!=</span><span class="token plain"> nil </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            return err</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        consumer</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token key atrule" style="color:#FAC863">err</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> = sarama.NewConsumerFromClient(client)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        if err </span><span class="token tag" style="color:#fc929e">!=</span><span class="token plain"> nil </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            return err</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        fmt.Println(&quot;Sending messages&quot;)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        go send_messages(producer)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        partConsumer</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token key atrule" style="color:#FAC863">err</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> = consumer.ConsumePartition(testTopicName</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token number" style="color:#5a9bcf">0</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> 0)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        if err </span><span class="token tag" style="color:#fc929e">!=</span><span class="token plain"> nil </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            return err</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token key atrule" style="color:#FAC863">for msg</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> = range partConsumer.Messages() </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            fmt.Printf(&quot;Read message </span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain"> %s\n&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> msg.Value)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        return nil</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    func main() </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        for </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token key atrule" style="color:#FAC863">err</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> = loop_kafka()</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            logrus.WithError(err).Println()</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            fmt.Println(&quot;Loop exited&quot;)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            time.Sleep(2 * time.Second)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> fs </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">require</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&#x27;fs&#x27;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> https </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">require</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&#x27;https&#x27;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> options </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token literal-property property" style="color:#5a9bcf">hostname</span><span class="token operator" style="color:#d7deea">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;server.otterize-tutorial-mtls&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token literal-property property" style="color:#5a9bcf">port</span><span class="token operator" style="color:#d7deea">:</span><span class="token plain"> </span><span class="token number" style="color:#5a9bcf">443</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token literal-property property" style="color:#5a9bcf">path</span><span class="token operator" style="color:#d7deea">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;/hello&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token literal-property property" style="color:#5a9bcf">method</span><span class="token operator" style="color:#d7deea">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;GET&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token literal-property property" style="color:#5a9bcf">cert</span><span class="token operator" style="color:#d7deea">:</span><span class="token plain"> fs</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">readFileSync</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&#x27;/var/otterize/credentials/cert.pem&#x27;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token literal-property property" style="color:#5a9bcf">key</span><span class="token operator" style="color:#d7deea">:</span><span class="token plain"> fs</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">readFileSync</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&#x27;/var/otterize/credentials/key.pem&#x27;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token literal-property property" style="color:#5a9bcf">ca</span><span class="token operator" style="color:#d7deea">:</span><span class="token plain"> fs</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">readFileSync</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&#x27;/var/otterize/credentials/ca.pem&#x27;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> req </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> https</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">request</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    options</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token parameter">res</span><span class="token plain"> </span><span class="token arrow operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        res</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">on</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&#x27;data&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token parameter">data</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token console class-name" style="color:#FAC863">console</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">log</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">toString</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">req</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">end</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> https </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">require</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token template-string template-punctuation string" style="color:#8dc891">`</span><span class="token template-string string" style="color:#8dc891">https</span><span class="token template-string template-punctuation string" style="color:#8dc891">`</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> fs </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">require</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token template-string template-punctuation string" style="color:#8dc891">`</span><span class="token template-string string" style="color:#8dc891">fs</span><span class="token template-string template-punctuation string" style="color:#8dc891">`</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> options </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token literal-property property" style="color:#5a9bcf">key</span><span class="token operator" style="color:#d7deea">:</span><span class="token plain"> fs</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">readFileSync</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&#x27;/var/otterize/credentials/key.pem&#x27;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token literal-property property" style="color:#5a9bcf">cert</span><span class="token operator" style="color:#d7deea">:</span><span class="token plain"> fs</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">readFileSync</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&#x27;/var/otterize/credentials/cert.pem&#x27;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token literal-property property" style="color:#5a9bcf">ca</span><span class="token operator" style="color:#d7deea">:</span><span class="token plain"> fs</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">readFileSync</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&#x27;/var/otterize/credentials/ca.pem&#x27;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token literal-property property" style="color:#5a9bcf">requestCert</span><span class="token operator" style="color:#d7deea">:</span><span class="token plain"> </span><span class="token boolean" style="color:#ff8b50">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">https</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">createServer</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    options</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token parameter">req</span><span class="token parameter punctuation" style="color:#8dc891">,</span><span class="token parameter"> res</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> peerCert </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> req</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token property-access">connection</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">getPeerCertificate</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">const</span><span class="token plain"> ownCert </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> req</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token property-access">connection</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">getCertificate</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token console class-name" style="color:#FAC863">console</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">log</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;Received request:&quot;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token console class-name" style="color:#FAC863">console</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">log</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">peerCert</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token property-access">subject</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token constant" style="color:#5a9bcf">CN</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">+</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;:\t&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">+</span><span class="token plain"> req</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token property-access">method</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">+</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot; &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">+</span><span class="token plain"> req</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token property-access">url</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#c5a5c5">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">req</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token property-access">url</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">===</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;/hello&#x27;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            res</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">writeHead</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token number" style="color:#5a9bcf">200</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            res</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">end</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&#x27;mTLS hello world\nfrom: &#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">+</span><span class="token plain"> ownCert</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token property-access">subject</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token constant" style="color:#5a9bcf">CN</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">+</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;\nto client: &#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">+</span><span class="token plain"> peerCert</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token property-access">subject</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token constant" style="color:#5a9bcf">CN</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#c5a5c5">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            res</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">end</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token method function property-access" style="color:#79b6f2">listen</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token number" style="color:#5a9bcf">443</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div></div></div></details><p>Deploy the client and server using <code>kubectl</code>:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">kubectl apply -f https://docs.otterize.com/code-examples/mtls/all.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Optional: check deployment status</summary><div><div class="collapsibleContent_i85q"><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">kubectl get pods -n otterize-tutorial-mtls</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You should see</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">NAME                      READY   STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">client-5689997b5c-grlnt   1/1     Running   0          35s</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">server-6698c58cbc-v9n9b   1/1     Running   0          34s</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><h2 class="anchor anchorWithStickyNavbar_LWe7" id="watch-it-in-action">Watch it in action<a class="hash-link" href="#watch-it-in-action" title="Direct link to heading">​</a></h2><ol><li><p>Confirm that the client can successfully call the server using HTTP with mTLS:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">kubectl logs --tail </span><span class="token number" style="color:#5a9bcf">3</span><span class="token plain"> -n otterize-tutorial-mtls deploy/client</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The client makes requests and prints out the server&#x27;s response; our example server will respond with
the <code>common name</code> of the server&#x27;s certificate as well as the <code>common name</code> of the client&#x27;s certificate:</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">mTLS hello world</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">from: server.otterize-tutorial-mtls          </span><span class="token comment" style="color:#999999"># server&#x27;s common name in the certificate</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">to client: client.otterize-tutorial-mtls     </span><span class="token comment" style="color:#999999"># client&#x27;s common name in the certificate</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>You can also confirm on the server side that it sees requests from this authenticated client:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">kubectl logs --tail </span><span class="token number" style="color:#5a9bcf">1</span><span class="token plain"> -n otterize-tutorial-mtls deploy/server</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The example server logs the common name of every client that makes a request:</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">client.otterize-tutorial-mtls:  GET /hello</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ol><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Certificate lifecycle management</div><div class="admonitionContent_S0QG"><p>Otterize leverages SPIRE or the Otterize Cloud credentials service to manage certificate lifecycle tasks such as rotation, revocation, etc.</p><p>We recommend reloading credentials before each use, as Otterize makes sure
the mounted credentials are constantly refreshed and up to date.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="inspect-credentials">Inspect credentials<a class="hash-link" href="#inspect-credentials" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-otterize-cloud">Using Otterize Cloud<a class="hash-link" href="#using-otterize-cloud" title="Direct link to heading">​</a></h3><p>Otterize Cloud can be used for visualizing your network and overlay certificate information. When you browse to <a href="https://app.otterize.com" target="_blank" rel="noopener noreferrer">https://app.otterize.com</a> you can see the access graph, showing you information about the services in your cluster, how they access each other, and so on. There are many other insights in the access graph, such as whether a service is or would be protected if enforcement were activated, or whether it would then block clients... but those are the subjects of the other tutorials.</p><p>If you click on the <strong>server</strong> service to see its details, you can expand and see the certificate details:</p><img loading="lazy" src="/img/quick-tutorials/mtls/creds.png" alt="Service details" width="600" class="img_ev3q"><p>You can see the common name (CN) used as the service&#x27;s identity. And, when available, this will also show all DNS names (SANs), which together with the CN encompass all the possible names attested for by this certificate.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-the-command-line">Using the command line<a class="hash-link" href="#using-the-command-line" title="Direct link to heading">​</a></h3><p>We can use <code>openssl</code> to inspect the generated credentials. The credentials are stored as a Kubernetes secret
and are then mounted as a file into the container.</p><ol><li><p>Retrieve the credentials from the Kubernetes secret:</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">kubectl get secret -n otterize-tutorial-mtls client-credentials-secret -o </span><span class="token assign-left variable" style="color:#d7deea">jsonpath</span><span class="token operator" style="color:#d7deea">=</span><span class="token string" style="color:#8dc891">&#x27;{.data.cert\.pem}&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">|</span><span class="token plain"> base64 -d </span><span class="token operator" style="color:#d7deea">&gt;</span><span class="token plain"> cert.pem</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Inspect the credentials with <code>openssl</code>:</p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">openssl x509 -in cert.pem -text </span><span class="token operator" style="color:#d7deea">|</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">head</span><span class="token plain"> -n </span><span class="token number" style="color:#5a9bcf">15</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You should see output similar to:</p><div class="language-x509 codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-x509 codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">Certificate:</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    Data:</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        Version: 3 (0x2)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        Serial Number:</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            0b:eb:eb:4d:0e:02:7e:28:93:30:1c:55:26:22:8b:c7</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        Signature Algorithm: sha256WithRSAEncryption</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        Issuer: C = ..., O = ...</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        Validity</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            Not Before: Aug 24 12:19:57 2022 GMT</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            Not After : Sep 23 12:20:07 2022 GMT</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#ffffff"><span class="token plain">        Subject: C = ..., O = ..., CN = client.otterize-tutorial-mtls       # the client&#x27;s name</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        Subject Public Key Info:</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            Public Key Algorithm: id-ecPublicKey</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                Public-Key: (256 bit)</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                pub:</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>You can see that Otterize generated an X.509 keypair using the pod&#x27;s name (&quot;client&quot;)
and namespace (&quot;otterize-tutorial-mtls&quot;): <code>client.otterize-tutorial-mtls</code>.</p></li></ol><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Expand to see what happened behind the scenes</summary><div><div class="collapsibleContent_i85q"><ol><li>We annotated the pods to let Otterize know it should generate mTLS credentials.</li><li>The Otterize credentials operator:<ol><li>Generated matching mTLS credentials.</li><li>Stored the mTLS credentials into Kubernetes secrets.</li></ol></li><li>The secrets were mounted (separately) into each pod&#x27;s container.</li><li>The pods communicated with each other using mutual TLS-authenticated HTTPS.</li></ol></div></div></details><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>Otterize defaults to generating credentials with an expiry time of 1 day. The certificates are
automatically refreshed before expiring, and therefore you must always read the credentials from file rather than caching them.</p><p>To set a longer expiration time, set the <code>credentials-operator.otterize.com/cert-ttl</code> annotation for your pods.
For more information, see <a href="/reference/configuration/credentials-operator">the documentation for the credentials operator</a></p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="whats-next">What&#x27;s next<a class="hash-link" href="#whats-next" title="Direct link to heading">​</a></h2><ul><li>Learn how to manage and <a href="/quick-tutorials/k8s-mtls">automatically provision mTLS</a> credentials within a Kubernetes cluster.</li><li>Enforce <a href="/quick-tutorials/k8s-kafka-mtls">secure Kafka access</a> with mTLS.</li><li>Learn more about how the <a href="/reference/configuration/credentials-operator">Otterize credentials operator</a> works.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="teardown">Teardown<a class="hash-link" href="#teardown" title="Direct link to heading">​</a></h2><p>To remove the deployed examples run:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">kubectl delete -f https://docs.otterize.com/code-examples/mtls/all.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/otterize/docs/edit/main/docs/quick-tutorials/k8s-mtls.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/quick-tutorials/k8s-network-mapper"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Simple Kubernetes cluster mapping</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/quick-visual-tutorials/visual-k8s-cluster-mapping"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Kubernetes cluster mapping</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#deploy-the-example" class="table-of-contents__link toc-highlight">Deploy the example</a></li><li><a href="#watch-it-in-action" class="table-of-contents__link toc-highlight">Watch it in action</a></li><li><a href="#inspect-credentials" class="table-of-contents__link toc-highlight">Inspect credentials</a><ul><li><a href="#using-otterize-cloud" class="table-of-contents__link toc-highlight">Using Otterize Cloud</a></li><li><a href="#using-the-command-line" class="table-of-contents__link toc-highlight">Using the command line</a></li></ul></li><li><a href="#whats-next" class="table-of-contents__link toc-highlight">What&#39;s next</a></li><li><a href="#teardown" class="table-of-contents__link toc-highlight">Teardown</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__links text--center"><div class="footer__links"><span class="footer__link-item">
                <div class="footer_left">

                    <div id="mailchimp_title" class="footer_signup">
                        Sign up for updates
                    </div>
                    <div class="footer_left-links">
                        <form id="mailchimp_form" class="footer_signup-form" name="embedded-subscribe-form">
                            <input id="mailchimp_email_input" style="color: white" type="email" name="EMAIL" class="footer_signup-input" placeholder="Email address" required="">
                            <button id="mailchimp_cta" type="submit" class="footer_signup-button">
                                <img src="/img/arrow_right_alt.svg" alt="Right arrow icon" class="footer_signup-img">
                            </button>
                        </form>
                    </div>
                </div>
                </span><span class="footer__link-separator">·</span><span class="footer__link-item"><div class="footer_right">
                            <div class="footer_privacy-policy">
                                <a href="https://otterize.com/privacy">privacy policy</a>
                            </div>
                            <div class="footer_right-links">
                                <a href="https://github.com/otterize/"><img src="/img/github-icon.svg"></a>
                                <a href="https://www.linkedin.com/company/otterize"><img src="/img/linkedin-icon.svg"></a>
                                <a href="https://joinslack.otterize.com/"><img src="/img/slack-icon.svg"></a>
                            </div>
                         </div></span><span class="footer__link-separator">·</span><span class="footer__link-item"><div class="footer_copyright">
                            Built with Docusaurus
                            <p>
                            © 2023 Otterize, Inc. All rights reserved.
                        </div></span></div></div></div></footer></div>
<script src="/assets/js/runtime~main.31873fae.js"></script>
<script src="/assets/js/main.b1380054.js"></script>
</body>
</html>